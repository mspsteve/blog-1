# 历史记录 history 产生、更改

导致历史记录变化的方式，主要有两种：
- 修改 location.hash
- history.pushState/popState 等 

以下以修改 location.hash 导致历史记录变化为例，详细说明历史记录栈的变化情况

## 新增历史记录
- 修改 location.hash 属性会更新显示在地址栏中的 URL，同时会在浏览器的历史记录栈中添加一条记录
- 修改 location.hash，浏览器只会滚动到页面相应位置，不会重新加载网页

## 历史记录不变的情况
- 刷新页面不会产生新的一条历史记录
- 刷新页面不会更改已有的历史记录栈（不管是当前页面之前还是之后的历史记录点），
- 点击回退和前进按钮或者调用 history 的 back、forward、go方法产生的后退、前进操作，不会更改历史记录栈，只会影响当面页面呈现哪一条历史记录

## 历史记录栈的更改
如果当前页面呈现的历史记录点不是历史记录栈里最后一条历史记录，则在新增历史记录时，会先销毁该历史记录点之后的历史记录，再新增一条历史记录。示例如下：
- 假设现有历史记录栈为： #1 -> #2 -> #3 -> #4，当前在 #4，此刻 history.length = 4
- 回退一次到 #3 ，此刻 history.length = 4（即回退时历史记录不会更改）
- 再回退一次到 #2 ，此刻 history.length = 4（即回退时历史记录不会更改）
- 再回退一次到 #1 ，此刻 history.length = 4（即回退时历史记录不会更改）
- 再前进一次到 #2 ，此刻 history.length = 4（即前进时历史记录不会更改）
- 可以直接修改地址栏里的 url，修改 hash 为 #5，此刻历史记录将变为：#1 -> #2 -> #5，且 history.length = 3。这说明在 #2 添加一条新的历史记录时，原先历史记录里位于 #2 之后的 #3、#4 都会被删除，并会在 #2 之后添加新的历史记录 #5

## 历史记录栈的销毁
- 只有关闭页面才会销毁整个历史记录栈